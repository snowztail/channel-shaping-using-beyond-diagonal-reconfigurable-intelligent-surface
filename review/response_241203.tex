\documentclass[
	fontsize=11pt,
	paper=a4,
	foldmarks=false
]{scrartcl}

\input{../manuscript/preamble}
\usepackage{response}


\setkomavar{signature}{Yang Zhao, Hongyu Li, Bruno Clerckx, and Massimo Franceschetti}
\setkomavar{date}{\today}
\setkomavar{subject}{Response to Decision on Manuscript T-SP-32387-2024}

\begin{document}
\begin{letter}{%
		Prof. Wei Yi\\
		Associate Editor\\
		IEEE Transactions on Signal Processing
	}
	\opening{Dear Editor and Reviewers,}
	Thank you for giving us the opportunity to submit a revised version of T-SP-32387-2024.
	Your comments and suggestions have been invaluable in helping us improve the quality of the manuscript.
	Below we prepare a point-to-point response and highlight the corresponding in-text changes, where labels have been matched to the latest version for your convenience.
	The title has been changed to \emph{MIMO Channel Shaping and Rate Maximization Using Beyond Diagonal RIS} to better reflect the content of the manuscript.
	We hope that the revisions and clarifications make the manuscript meet the standards of TSP publications.
	\closing{Yours sincerely,}
\end{letter}


\begin{editor}
	\summary{
		The reviewers raised a number of concerns regarding the paper's contribution, novelty, and mathematical correctness, which led to the recommendation for rejection. The main issues identified include:
		\begin{enumerate}
			\item The contribution of the paper is unclear. Specifically, the proposed framework in \eqref{op:shaping} is not sufficiently general as it does not consider \gls{bd}-\gls{ris} dependent constraints (e.g., \gls{qos}, sensing quality). A more general case has already been investigated and solved in the authors' previous work \cite{Zhou2023}. Some content in Section \ref{sc:shaping_numerical} are well established methods in the literature \cite{Abrudan2008}. \label{sm:a}
			\item The optimization problems \eqref{op:power} and \eqref{op:rate_ris} lacks of novelty. The reviewer pointed that they can be possibly solved by existing methods through appropriate adjustment \cite{Santamaria2023,Li2023b}. Also, it is also pointed out that Corollaries \ref{co:nd_sv_prod_subset} -- \ref{co:nd_sv_prod_tail} are the standard results from matrix textbook. \label{sm:b}
			\item The correctness and usefulness of the mathematical derivations. For example, the derivation in the proof of Appendix \ref{ap:shaping} is incorrect. Convergence proof in Appendix \ref{ap:power} is questionable. The usefulness of these bounds on singular values of the effective channel $\mathbf{H}$ is unclear. \label{sm:c}
			\item The literature review can be enhanced to cover a boarder range of papers that related to the problem addressed. \label{sm:d}
			\item The simulation study can be enhanced. For example, comparisons with the \gls{d}-\gls{ris} and a globally passive \gls{bd}-\gls{ris} were suggested by the reviewer. \label{sm:e}
		\end{enumerate}
	}

	\reply{
		We appreciate the editor's summary of the comments. We have carefully considered each point raised and have made significant revisions to address these concerns. Please refer to \ref{cm:a} for \ref{sm:a}, \ref{cm:b1} and \ref{cm:b2} for \ref{sm:b}, \ref{cm:c1} and \ref{cm:c2} and \ref{cm:b2} for \ref{sm:c}, \ref{cm:b1} for \ref{sm:d}, and \ref{cm:e} for \ref{sm:e} in the following responses.
	}

\end{editor}

\begin{reviewer}
	\summary{
		This manuscript investigates the impact of \gls{bd}-\gls{ris} to the distribution of singular values of \gls{mimo} channel of a point-to-point communication system. Especially, the authors derive bounds of singular values of \gls{bd}-\gls{ris} channel and propose algorithms to design \gls{bd}-\gls{ris} configuration.
	}

	\comment{
		\label{cm:a}
		The contribution of Sec. \ref{sc:shaping_numerical} is unclear for the following two reasons.
		\begin{enumerate}
			\item The manuscript claims to propose a universal optimization framework for \gls{bd}-\gls{ris} as in \eqref{op:shaping}. However, the framework in \eqref{op:shaping} is indeed not sufficiently general. It does not consider \gls{bd}-\gls{ris} dependent constraints (e.g., \gls{qos}, sensing quality) besides the orthogonal conditions \eqref{cn:shaping_unitary}. The reviewer notice that a more general framework, which considers \gls{bd}-\gls{ris} constraints in addition to \eqref{cn:shaping_unitary}, has already been investigated and solved in the authors' previous work \cite{Zhou2023}.
			\item Besides, both the non-geodesic \gls{rcg} and geodesic \gls{rcg} algorithms, e.g., \eqref{eq:gradient_eucl} -- \eqref{eq:geodesic_tran}, are well established methods in the literature, e.g., \cite{Abrudan2008}. Therefore, the novelty of Sec. \ref{sc:shaping_numerical} unclear.
		\end{enumerate}
	}

	\reply{
		We appreciate the reviewer's insightful comments.
		The geodesic \gls{rcg} algorithm for unitary-constrained problems has indeed been proposed in the optimization literature.
		Our contribution is an extension to block-unitary cases with parallel or unified updates that accelerate the design of group-connected \gls{bd}-\gls{ris}.
		The claim of ``universal optimization framework'' and the non-geodesic \gls{rcg} method have been removed and we have completely reworked the optimization part to reflect the particular contributions (channel shaping).
		The content is too long to fit here and we kindly ask the reviewer to refer to Section \ref{sc:shaping_numerical} of the revised manuscript for details.
	}

	\comment{
		In Sec. \ref{sc:shaping_numerical}, the manuscript proposes to maximize weighted sum of singular values of the effective channel $\mathbf{H}$. The optimization objective is rather vague. Is the weighted sum of singular values related to any meaningful performance metric (e.g., capacity, power gain, and so on)?
	}

	\reply{
		This is an important question.
		The weighted sum of singular values plays a crucial role in channel shaping since it helps to reveal the achievable singular value region.
		We believe itself could serve as a metric for measuring the \gls{mimo} channel shaping capability of different \gls{ris}.
		We have added a detailed explanation in the revised manuscript and the answer which we copy in the two boxes below.

		\change{
			To validate Algorithm~\ref{ag:rcg} and quantify the shaping capability of \gls{bd}-\gls{ris}, we characterize the achievable singular value region of \gls{bd}-\gls{ris}-aided \gls{mimo} channel by considering the Pareto optimization problem
			\begin{maxi*}
				{\scriptstyle{\mathbf{\Theta}}}{\sum_{n=1}^N \rho_n \sigma_n(\mathbf{H})}{}{}
				\addConstraint{\mathbf{\Theta}_g^\mathsf{H} \mathbf{\Theta}_g=\mathbf{I},}{\quad \forall g,}
			\end{maxi*}
			where $\rho_n \ge 0$ is the weight associated with the $n$-th channel singular value.
			Varying those weights help to characterize the Pareto frontier of singular values that encloses the achievable region.
			While the objective \eqref{ob:pareto} itself seems obscure, a larger quantity translates to a stronger singular value redistribution capability and thus better wireless performance (e.g., channel capacity for communication, detection probability for sensing, and harvestable energy for power transfer).
			Problem \eqref{op:pareto} also generalizes the \gls{dof} problem in Proposition \ref{pp:dof} and the individual singular value shaping problem in Corollary \ref{co:nd_sv_indl} and Proposition \ref{pp:rd}.
			It can be solved optimally by Algorithm~\ref{ag:rcg} with $[\mathbf{D}]_{n,n} = \rho_n$ in \eqref{eq:shaping_subdiff}.
		}

		\change{
			\setcounter{figure}{1}
			\begin{figure}[H]
				\centering
				\subfloat[$2 \times 32 \times 2$ (no direct)]{
					\resizebox{!}{3.25cm}{
						\input{../assets/simulation/pc_singular_pareto_sx32_nd.tex}

					}
				}
				\subfloat[$2 \times 32 \times 2$]{
					\resizebox{!}{3.25cm}{
						\input{../assets/simulation/pc_singular_pareto_sx32.tex}
					}
				}
				\\
				\subfloat[$2 \times 64 \times 2$]{
					\resizebox{!}{3.25cm}{
						\input{../assets/simulation/pc_singular_pareto_sx64.tex}
					}
				}
				\subfloat[$2 \times 128 \times 2$]{
					\resizebox{!}{3.25cm}{
						\input{../assets/simulation/pc_singular_pareto_sx128.tex}
					}
				}
				\caption{Achievable singular value regions of an $N_\mathrm{T}=N_\mathrm{R}=2$ channel shaped by \gls{bd}-\gls{ris}. The singular value pair of the direct channel are marked as baseline.
				On the Pareto frontiers, `P-max', `E-max', and `R-max' refer to the channel power gain-optimal point, wireless power transfer-optimal point, and rate-optimal arc, respectively.}
			\end{figure}
			Fig. \ref{fg:singular_pareto} illustrates the achievable regions of singular values of an $N_\mathrm{T}=N_\mathrm{R}=2$ point-to-point \gls{mimo} shaped by \gls{ris}, where the channel power gain-optimal point, wireless power transfer-optimal point, and rate-optimal arc are highlighted on the Pareto frontiers.
			As the \gls{snr} increases, the rate-optimal point proceeds on the arc from the east (favoring $\sigma_1(\mathbf{H})$) to the north (favoring $\sigma_2(\mathbf{H})$).
			The results are obtained by solving the channel shaping problem \eqref{op:pareto} merely without any application-specific optimization, and we conjecture that the Pareto frontier includes the optimal singular value points of other wireless applications (e.g., sensing).
			When the direct channel is negligible, the achievable regions in Fig. \subref*{fg:singular_pareto_sx32_nd} are shaped like pizza slices.
			This is because $\sigma_1(\mathbf{H}) \ge \sigma_2(\mathbf{H})$ and there exists a trade-off between the alignment of two modes.
			The smallest singular value can be enhanced up to \num{2e-4} by \gls{d}-\gls{ris} and \num{3e-4} by fully-connected \gls{bd}-\gls{ris}, corresponding to a \qty{50}{\percent} gain.
			We also see that for fully-connected \gls{bd}-\gls{ris}, the power gain-optimal and rate-optimal points coincide with each other, as derived in  \eqref{eq:ris_nd_power_max} and \eqref{eq:ris_nd_rate_max}.
			This observation still holds in Figs. \subref*{fg:singular_pareto_sx32} -- \subref*{fg:singular_pareto_sx128} where the direct channel is significant, yet a formal proof is unavailable due to the non-trivial solution structures.
			The shape of the singular value region depends heavily on the relative strength of the indirect channels, which is $\Lambda_\mathrm{F}\Lambda_\mathrm{B}/\Lambda_\mathrm{D}=\qty{-35}{dB}$.
			Fig. \subref*{fg:singular_pareto_sx32} shows that a 32-element \gls{ris} is insufficient to compensate this imbalance and results in a limited singular value region that is symmetric around the direct point.
			As the group size $L$ increases, the shape of the region evolves from elliptical to square.
			This transformation not only improves the dynamic range of $\sigma_1(\mathbf{H})$ and $\sigma_2(\mathbf{H})$ by \qty{22}{\percent} and \qty{38}{\percent}, but also provides a better trade-off in manipulating both singular values.
			It verifies that the design flexibility of \gls{bd}-\gls{ris} allows better alignment of multiple modes simultaneously.
			As a consequence, \emph{the optimally shaped channels for different applications coincide with each other,} which emphasizes the benefits of \emph{multi-functional} \gls{bd}-\gls{ris}.
			The singular value region also enlarges as the number of scattering elements $N_\mathrm{S}$ increases.
			In particular, Fig. \subref*{fg:singular_pareto_sx128} shows that the equivalent channel can be completely nulled (corresponding to the origin) by a 128-element \gls{bd}-\gls{ris} but not by a diagonal one, which can be leveraged for interference mitigation and secure communication.
			Those results demonstrate the superior channel shaping capability of \gls{bd}-\gls{ris} and emphasizes the importance of adding reconfigurable inter-connections between elements.
		}
	}

	\comment{
		\label{cm:c1}
		Derivation in the proof of Appendix \ref{ap:shaping} is incorrect. Specifically, $(\partial \mathbf{u}^\mathsf{T}) \cdot \mathbf{u}$ is not equal to $\partial (\mathbf{u}^T \mathbf{u})$. Similar error occurs to $\mathbf{v}$. Please note that the derivative of singular value of a matrix with respect to the matrix itself does not exist. In fact, sub-differential should be used instead, e.g., \cite{Cai2010}.
	}

	\reply{
		We appreciate the reviewer for pointing out the error.
		We have corrected the derivation in the proof of Appendix \ref{ap:shaping} and have used the sub-differential to handle the non-differentiability of the singular value function.
		\change{
			Consider a special class of channel shaping problem
			\begin{maxi*}
				{\scriptstyle{\mathbf{\Theta}}}{f\bigl(\sv(\mathbf{H})\bigr)}{}{}
				\addConstraint{\mathbf{\Theta}_g^\mathsf{H} \mathbf{\Theta}_g=\mathbf{I},}{\quad \forall g,}
			\end{maxi*}
			where $f: \mathbb{R}^{N} \to \mathbb{R}$ is a symmetric gauge function (i.e., a norm invariant under sign change and argument permutation) \cite{Watson1992}.
			Examples of such $f$ include the Ky Fan $k$ norm, Schatten $p$ norm, $n$-th singular value, and channel power gain.
			Problem \eqref{op:shaping} is non-convex due to the unitary constraints \eqref{cn:shaping_unitary} and non-smooth due to the possibility of repeated singular values or singular values crossing each other.
			\setcounter{proposition}{3}
			\begin{proposition}
				The sub-differential of \eqref{ob:shaping} with respect to \gls{bd}-\gls{ris} block $g$ is
				\begin{equation*}
					\partial_{\mathbf{\Theta}_g^*} f\bigl(\sv(\mathbf{H})\bigr) = \conv \bigl\{ \mathbf{H}_{\mathrm{B},g}^\mathsf{H} \mathbf{U} \mathbf{D} \mathbf{V}^\mathsf{H} \mathbf{H}_{\mathrm{F},g}^\mathsf{H} \bigr\},
				\end{equation*}
				where $\mathbf{D} \in \mathbb{C}^{N_\mathrm{R} \times N_\mathrm{T}}$ is a rectangular diagonal matrix with $[\mathbf{D}]_{n,n} \in \partial_{\sigma_n(\mathbf{H})} f\bigl(\sv(\mathbf{H})\bigr)$, $\forall n \in [N]$, and $\mathbf{U}$, $\mathbf{V}$ are any left and right singular matrices of $\mathbf{H}$.
			\end{proposition}
		}
	}

	\comment{
		\label{cm:c2}
		The rank equation in the proof of Prop. \ref{pp:dof} (Appendix \ref{ap:dof}) seems confusing. The rank of product of two matrices is: $\rank(\mathbf{AB}) = \rank(\mathbf{B}) - \dim(\ker(\mathbf{A}) \cap \ran(\mathbf{B}))$. How could one obtain the rank equation in Appendix \ref{ap:dof}? Please clarify.
	}

	\reply{
		Using the rank equation pointed out by the reviewer, we realized that the achievability proof was incorrect, and the proposition itself was incorrect.
		We really appreciate the reviewer for pointing out this mistake!
		A new proof in Appendix \ref{ap:dof} shows that \gls{bd}-\gls{ris} may achieve a larger or smaller number of \gls{mimo} \gls{dof} than \gls{d}-\gls{ris}.
		The change in the main text is as follows.
		\change{
			\setcounter{proposition}{0}
			\begin{proposition}[Degrees of freedom]
				\gls{bd}-\gls{ris} may achieve a larger or smaller \gls{mimo} \gls{dof}\footnotetext{Here communication \gls{dof} refers to the maximum number of independent streams that can be transmitted in parallel over a \gls{mimo} channel, i.e., $\mathrm{DoF}(\mathbf{H}) = \lim_{\rho \to \infty} \frac{\log \det(\mathbf{I} + \rho \mathbf{H} \mathbf{H}^\mathsf{H})}{\log \rho}$ where $\rho$ is the \gls{snr}. The concept is closely related to radar \gls{dof} which refers to the number of independent measurements.} than \gls{d}-\gls{ris}.
			\end{proposition}
			\begin{proof}
				Please refer to Appendix~\ref{ap:dof}.
			\end{proof}

			While increasing the \gls{dof} improves the asymptotic rate performance for point-to-point transmission, the ability to reduce the \gls{dof} can be exploited to orthogonalize channels and align interference in multi-user scenarios.
			% reducing the \gls{dof} does not necessarily degrade the rate at finite \gls{snr}.
			% , it does not necessarily imply a higher rate at finite \gls{snr}.
			% It is worth mentioning that a larger \gls{dof} implies more parallel streams or less interference, which is beneficial for high-rate communication.

			\begin{example}[\gls{dof} of $4 \times 4 \times 4$ shaping]
				Consider a $4 \times 4 \times 4$ shaping with $\mathbf{H}_\mathrm{D} = \mathbf{0}$ and
				\begin{equation*}
					\mathbf{H}_\mathrm{B} =
					\begin{bmatrix}
						1 & 1 & 0 & 0 \\
						0 & 0 & 0 & 0 \\
						0 & 0 & 1 & 0 \\
						0 & 0 & 0 & 0
					\end{bmatrix}, \quad
					\mathbf{H}_\mathrm{F} =
					\begin{bmatrix}
						1 & 0 & 0 & 0 \\
						0 & 1 & 0 & 0 \\
						0 & 0 & 0 & 0 \\
						0 & 0 & 0 & 0
					\end{bmatrix}.
				\end{equation*}
				Evidently, any \gls{d}-\gls{ris} $\mathbf{\Theta}_\mathrm{D} = \diag(e^{\jmath \theta_1}, e^{\jmath \theta_2}, e^{\jmath \theta_3}, e^{\jmath \theta_4})$ results in
				\begin{equation*}
					\mathbf{H} =
					\begin{bmatrix}
						e^{\jmath \theta_1} & e^{\jmath \theta_2} & 0 & 0 \\
						0 & 0 & 0 & 0 \\
						0 & 0 & 0 & 0 \\
						0 & 0 & 0 & 0
					\end{bmatrix}
				\end{equation*}
				and achieves a \gls{dof} of 1.
				On the other hand, as instructed by \eqref{eq:ris_dof_max} and \eqref{eq:ris_dof_min}, fully-connected \gls{bd}-\gls{ris} $\mathbf{\Theta}_{\textnormal{DoF-max}}^{\textnormal{MIMO}} =
				\begin{bsmallmatrix}
					0 & \frac{\sqrt{2}}{2} & 0 & -\frac{\sqrt{2}}{2} \\
					0 & \frac{\sqrt{2}}{2} & 0 & \frac{\sqrt{2}}{2} \\
					-1 & 0 & 0 & 0 \\
					0 & 0 & 1 & 0
				\end{bsmallmatrix}$ and $\mathbf{\Theta}_{\textnormal{DoF-min}}^{\textnormal{MIMO}} =
				\begin{bsmallmatrix}
					-\frac{\sqrt{2}}{2} & 0 & \frac{\sqrt{2}}{2} & 0\\
					\frac{\sqrt{2}}{2} & 0 & \frac{\sqrt{2}}{2} & 0 \\
					0 & 0 & 0 & 1 \\
					0 & -1 & 0 & 0
				\end{bsmallmatrix}$
				result in
				\begin{equation*}
					\mathbf{H} =
					\begin{bmatrix}
						0 & \sqrt{2} & 0 & 0 \\
						0 & 0 & 0 & 0 \\
						-1 & 0 & 0 & 0 \\
						0 & 0 & 0 & 0
					\end{bmatrix}, \quad
					\mathbf{H} = \mathbf{0},
				\end{equation*}
				and achieve \gls{dof} of 2 and 0, respectively.
			\end{example}

			Proposition \ref{pp:dof} and Example \ref{eg:dof} suggest that we can expect more parallel streams or less interference when shaping the channel with \gls{bd}-\gls{ris}.
			We now take a step further to examine the limits of redistributing channel singular values under specific channel conditions.
		}
	}

	\comment{
		\label{cm:b1}
		In Sec. \ref{sc:shaping_analytical}, the manuscript provides a number of bounds on singular values of the effective channel $\mathbf{H}$. However, the usefulness of these bounds is unclear. What can these bounds be used for? Note the results in Corollaries \ref{co:nd_sv_prod_subset} -- \ref{co:nd_sv_prod_tail} are quite standard results from matrix textbook. The (upper) bound in Corollary \ref{co:nd_power}, which is achieved by aligning its left and right singular-value vectors to that of the forward and backward channels, respectively, is reminiscent of the results in seminal papers on relay beamforming design, e.g., \cite{Rong2009,Rong2009a}.
	}

	\reply{
		We would like to argue that, while Corollaries \ref{co:nd_sv_prod_subset} -- \ref{co:nd_sv_prod_tail} are standard mathematical results, it is Proposition \ref{pp:nd} that allows one to recast the channel shaping question as a well-studied linear algebra problem and enable those.
		In the revised manuscript, we have emphasized above and have also added
		\begin{itemize}
			\item Upper and lower bounds on individual singular value in Corollary \ref{co:nd_sv_indl};
			\item Lower bound on channel power gain in Corollary \ref{co:nd_power};
			\item Upper bound on channel capacity at general \gls{snr} in Corollary \ref{co:nd_capacity_snr_general} and at extreme \gls{snr} in \ref{co:nd_capacity_snr_extreme}.
		\end{itemize}
		The corresponding \gls{ris} scattering matrices have also been derived in closed form.
		We believe those bounds and \gls{ris} expressions not only serve as benchmarks but also motivate low-complexity designs (e.g., Section \ref{sc:rate_lc}) in various wireless applications.
		For example, the bounds on the $n$-th singular value can be used to simplify precoding design in \gls{mimo} systems with limited number $n$ of RF chains.
		The comparison to relay beamforming design is insightful and we have added footnote \ref{fn:power_nd_max} to highlight the connection.
		\change{
			\setcounter{proposition}{3}
			\setcounter{corollary}{2}
			\begin{corollary}[Individual singular value]
				If the direct channel is negligible,
				then the $n$-th channel singular value can be manipulated up to
				\begin{equation*}
					\max_{\mathclap{i+j=n+N_\mathrm{S}}} \ \sigma_i(\mathbf{H}_\mathrm{B}) \sigma_j(\mathbf{H}_\mathrm{F}) \le \sigma_n(\mathbf{H}) \le \min_{\mathclap{i+j=n+1}} \ \sigma_i(\mathbf{H}_\mathrm{B}) \sigma_j(\mathbf{H}_\mathrm{F}),
				\end{equation*}
				where $(i, j) \in [N_\mathrm{S}]^2$.
				The upper and lower bounds are attained respectively at
				\begin{align*}
					\mathbf{\Theta}_{\textnormal{sv-}n\textnormal{-max}}^\textnormal{MIMO-ND} & = \mathbf{V}_\mathrm{B} \mathbf{P} \mathbf{U}_\mathrm{F}^\mathsf{H}, \\
					\mathbf{\Theta}_{\textnormal{sv-}n\textnormal{-min}}^\textnormal{MIMO-ND} & = \mathbf{V}_\mathrm{B} \mathbf{Q} \mathbf{U}_\mathrm{F}^\mathsf{H},
				\end{align*}
				where $\mathbf{V}_\mathrm{B}, \mathbf{U}_\mathrm{F} \in \mathbb{U}^{N_\mathrm{S} \times N_\mathrm{S}}$ are any right and left singular matrices\footnotetext{%
					We highlight the non-uniqueness of $\mathbf{V}_\mathrm{B}$ and $\mathbf{U}_\mathrm{F}$. When a singular value has multiplicity $k$, the corresponding singular vectors can be any orthonormal basis of the $k$-dimensional subspace. Even if all singular values are distinct, the singular vectors of each can be scaled by a phase factor of choice.} of $\mathbf{H}_\mathrm{B}$ and $\mathbf{H}_\mathrm{F}$, respectively,
				and $\mathbf{P}$ and $\mathbf{Q}$ are arbitrary permutation matrices of dimension $N_\mathrm{S}$ satisfying:
				\begin{itemize}
					\item The $(i, j)$-th entry is $1$, where
					\begin{align*}
						(i, j) &=
						\begin{cases}
							\underset{\mathclap{i+j=n+1}}{\arg\min} \ \sigma_i(\mathbf{H}_\mathrm{B}) \sigma_j(\mathbf{H}_\mathrm{F}), & \text{for } \mathbf{P}, \\
							\underset{\mathclap{i+j=n+N_\mathrm{S}}}{\arg\max} \ \sigma_i(\mathbf{H}_\mathrm{B}) \sigma_j(\mathbf{H}_\mathrm{F}), & \text{for } \mathbf{Q}.
						\end{cases}
					\end{align*}
					and ties may be broken arbitrarily;
					\item After deleting the $i$-th row and $j$-th column, the resulting submatrix $\mathbf{Y}$ is arbitrary permutation matrix of dimension $N_\mathrm{S}-1$ satisfying
					\begin{alignat*}{2}
						\sigma_{n{-}1}(\hat{\mathbf{\Sigma}}_{\mathrm{B}} \mathbf{Y} \hat{\mathbf{\Sigma}}_{\mathrm{F}}) & {\ge} \ \ \min_{\mathclap{i+j=n+1}} \ \sigma_i(\mathbf{H}_\mathrm{B}) \sigma_j(\mathbf{H}_\mathrm{F})            &  & \text{ for } \mathbf{P}, \\
						\sigma_{n{+}1}(\hat{\mathbf{\Sigma}}_{\mathrm{B}} \mathbf{Y} \hat{\mathbf{\Sigma}}_{\mathrm{F}}) & {\le} \ \ \max_{\mathclap{i+j=n+N_\mathrm{S}}} \ \sigma_i(\mathbf{H}_\mathrm{B}) \sigma_j(\mathbf{H}_\mathrm{F}) &  & \text{ for } \mathbf{Q},
					\end{alignat*}
					where $\hat{\mathbf{\Sigma}}_{\mathrm{B}}$ and $\hat{\mathbf{\Sigma}}_{\mathrm{F}}$ are diagonal singular value matrices of $\mathbf{H}_\mathrm{B}$ and $\mathbf{H}_\mathrm{F}$ with both $i$-th row and $j$-th column deleted, respectively.
				\end{itemize}
			\end{corollary}
			Corollary \ref{co:nd_sv_indl} and Proposition \ref{pp:rd} both reveal the shaping limits of the $n$-th largest channel singular value, which may be used to simplify the \gls{mimo} precoder design with limited number $n$ of \gls{rf} chains.
			They are derived under different assumptions are not special cases of each other.
			Importantly, Corollary \ref{co:nd_sv_indl} establishes upper and lower bounds for \emph{each} channel singular value (c.f. first and last few in Proposition \ref{pp:rd}), applies to fully-connected \gls{bd}-\gls{ris} of arbitrary size, and provides a general solution structure.
		}

		\change{
			\begin{corollary}[Channel power gain]
				If the direct channel is negligible, then the channel power gain is bounded from above (resp. below) by the inner product of squared singular values of $\mathbf{H}_\mathrm{B}$ and $\mathbf{H}_\mathrm{F}$ when they are sorted similarly (resp. oppositely), that is,\footnotetext{As a side note, we notice \cite{Fang1994} discussed a similar bound using extreme singular values $\max\bigl(\sigma_{N}(\mathbf{H}_\mathrm{B}) \lVert \mathbf{H}_\mathrm{F} \rVert _\mathrm{F}^2, \sigma_{N}(\mathbf{H}_\mathrm{F}) \lVert \mathbf{H}_\mathrm{B} \rVert _\mathrm{F}^2\bigr) \le \lVert \mathbf{H} \rVert _\mathrm{F}^2 \le \min\bigl(\sigma_1(\mathbf{H}_\mathrm{B}) \lVert \mathbf{H}_\mathrm{F} \rVert _\mathrm{F}^2, \sigma_1(\mathbf{H}_\mathrm{F}) \lVert \mathbf{H}_\mathrm{B} \rVert _\mathrm{F}^2\bigr)$. This is a looser version of \eqref{iq:power_nd} and cannot take equalities unless the extreme singular values are of multiplicity $N$.}
				\begin{equation*}
					\sum_{n=1}^N \sigma_n^2(\mathbf{H}_\mathrm{B}) \sigma_{N_\mathrm{S}-n+1}^2(\mathbf{H}_\mathrm{F}) \le \lVert \mathbf{H} \rVert _\mathrm{F}^2 \le \sum_{n=1}^N \sigma_n^2(\mathbf{H}_\mathrm{B}) \sigma_n^2(\mathbf{H}_\mathrm{F}),
				\end{equation*}
				whose upper\footnotetext{The upper bound \eqref{eq:ris_nd_power_max} is reminiscent of the optimal amplify-and-forward relay beamforming design \cite[(16), (17)]{Rong2009a} where the diagonal matrices boil down to $\mathbf{I}$ due to the passive nature of \gls{ris}.} and lower bounds are attained respectively at
				\begin{align*}
					\mathbf{\Theta}_\textnormal{P-max}^\textnormal{MIMO-ND} & = \mathbf{V}_\mathrm{B} \mathbf{U}_\mathrm{F}^\mathsf{H},             \\
					\mathbf{\Theta}_\textnormal{P-min}^\textnormal{MIMO-ND} & = \mathbf{V}_\mathrm{B} \mathbf{J} \mathbf{U}_\mathrm{F}^\mathsf{H},
				\end{align*}
				where $\mathbf{J}$ is the exchange (a.k.a. backward identity) matrix of dimension $N_\mathrm{S}$.
			\end{corollary}
			We notice that \eqref{eq:ris_nd_power_max} and \eqref{eq:ris_nd_power_min} are special cases of \eqref{eq:ris_nd_sv_indl_max} and \eqref{eq:ris_nd_sv_indl_min} with $\mathbf{P} = \mathbf{I}$ and $\mathbf{Q} = \mathbf{J}$, which also attain the right and left halves of \eqref{iq:sv_nd_extreme}, respectively.
		}

		\change{
			\begin{corollary}[Channel capacity at general \gls{snr}]
				If the direct channel is negligible, then the \gls{bd}-\gls{ris} aided \gls{mimo} channel capacity is
				\begin{equation*}
					C^\textnormal{MIMO-ND} = \sum_{n=1}^N \log \left(1 + \frac{s_n \sigma_n^2(\mathbf{H}_\mathrm{B}) \sigma_n^2(\mathbf{H}_\mathrm{F})}{\eta}\right),
				\end{equation*}
				where $\eta$ is the average noise power, $s_n = \mu - \frac{\eta}{\sigma_n^2(\mathbf{H}_\mathrm{B}) \sigma_n^2(\mathbf{H}_\mathrm{F})}$ is the power allocated to the $n$-th mode obtainable by the water-filling algorithm \cite{Clerckx2013}.
				The capacity-achieving \gls{bd}-\gls{ris} scattering matrix is
				\begin{equation*}
					\mathbf{\Theta}_\textnormal{R-max}^\textnormal{MIMO-ND} = \mathbf{V}_\mathrm{B} \mathbf{U}_\mathrm{F}^\mathsf{H}.
				\end{equation*}
			\end{corollary}
			Corollary \ref{co:nd_capacity_snr_general} also suggests that the power- and rate-optimal scattering matrices \eqref{eq:ris_nd_power_max} and \eqref{eq:ris_nd_rate_max} coincide with each other when the direct channel is negligible and the \gls{bd}-\gls{ris} is fully-connected.
			When either condition is not satisfied, active and passive beamforming are coupled and the rate-optimal solution involves alternating optimization.
			However, the power-optimal \gls{ris} still provides for a low-complexity decoupled solution.
			The details will be discussed in Section~\ref{sc:rate}.
		}

		\change{
			\begin{corollary}[Channel capacity at extreme \gls{snr}]
				If the direct channel is negligible, then the channel capacity when the \gls{snr} $\rho$ is very low and high are approximately bounded from above by
				\begin{align*}
					C_{\rho_\downarrow} & \lessapprox \sigma_1^2(\mathbf{H}_\mathrm{B}) \sigma_1^2(\mathbf{H}_\mathrm{F}),                                            \\
					C_{\rho_\uparrow}   & \lessapprox N \log \frac{\rho}{N} + 2 \log \prod_{n=1}^N \sigma_n(\mathbf{H}_\mathrm{B}) \sigma_n(\mathbf{H}_\mathrm{F}).
				\end{align*}
			\end{corollary}
		}
	}

	\comment{
		\label{cm:b2}
		The optimization problems \eqref{op:power} and \eqref{op:rate_ris} lacks of novelty. In fact, they can still be solved by the methods proposed in existing literature, e.g., \cite{Santamaria2023,Li2023b} through appropriate adjustment.
	}

	\reply{
		We agree with the reviewer that problem \eqref{op:rate_ris} may be solved by the method proposed in \cite{Li2023b} with appropriate adjustment.
		We believe our method is more efficient as evident from Table \ref{tb:complexity_algorithm}.
		However, although problem \eqref{op:power} has been studied in symmetric \gls{bd}-\gls{ris}-aided \gls{miso} \cite{Santamaria2023} where only one mode is available, generalizing those to \gls{mimo} is non-trivial due to trade-off between modes.
		We have also added footnote \ref{fn:power_gain} to clarify this point.
		\change{
			Problem \eqref{op:power} has been studied in \gls{siso} \cite{Shen2020a} and \gls{miso} equivalents \cite{Santamaria2023,Fang2023,Nerini2023,Nerini2023b} where only one mode is available. Generalizing those to \gls{mimo} is non-trivial due to trade-off between modes.
		}
	}

	\comment{
		Convergence proof in Appendix \ref{ap:power} is questionable. First, the manuscript just assumes that solution iterates $\tilde{\mathbf{\Theta}}$ converge. This may not be true (solution iterate could oscillate actually) and is hard to prove. Second, stationary point for constrained problem is more complicated than for the non-constrained case (e.g.  gradient equals zero). Please refer to \cite{Pang2017}.
	}

	\reply{
		We appreciate the reviewer for pointing out the issue.
		Indeed, the sequence of iterates may oscillate and the convergence proof in the previous version was incorrect.
		We have revised the wording in Proposition \ref{pp:power} and clarified the condition when a stationary point can be reached.
		The proof in Appendix \ref{ap:power} has been updated accordingly.
		\setcounter{proposition}{4}
		\change{
			\begin{proposition}
				Starting from any feasible $\mathbf{\Theta}^{(0)}$, the sequence\footnotetext{However, \eqref{eq:ris_power} might not converge to a single solution point when $\mathbf{M}_g$ is rank-deficient due to the non-uniqueness of the orthonormal bases of kernels.}
				\begin{equation*}
					\mathbf{\Theta}_g^{(r+1)} = \mathbf{U}_g^{(r)} \mathbf{V}_g^{(r)}, \quad \forall g
				\end{equation*}
				monotonically increases the objective function \eqref{ob:power},
				where $\mathbf{U}_g^{(r)}$ and $\mathbf{V}_g^{(r)}$ are any left and right singular matrices of\footnotetext{We notice that $\mathbf{\Theta}_g$ coincides with the orthogonal projection of $\mathbf{M}_g$ onto the Stiefel manifold $\pi(\mathbf{M}_g) = {\arg\min}_{\mathbf{X}_g \in \mathbb{U}^{L \times L}} \lVert \mathbf{M}_g - \mathbf{X}_g \rVert _\mathrm{F} = \mathbf{U}_g \mathbf{V}_g$.} % \cite{Manton2002}
				\begin{equation*}
					\mathbf{M}_g^{(r)} = \mathbf{H}_{\mathrm{B},g}^\mathsf{H} \Bigl(\mathbf{H}_\mathrm{D} + \mathbf{H}_\mathrm{B} \diag\bigl(\mathbf{\Theta}_{[1:g-1]}^{(r+1)},\mathbf{\Theta}_{[g:G]}^{(r)}\bigr) \mathbf{H}_\mathrm{F}\Bigr) \mathbf{H}_{\mathrm{F},g}^\mathsf{H}.
				\end{equation*}
				Besides, when \eqref{eq:auxiliary_power} converges, \eqref{eq:ris_power} leads to a convergence of the objective function \eqref{ob:power} towards a stationary point.
			\end{proposition}
		}

		\change{
			\setcounter{remark}{2}
			\begin{remark}
				The sequence \eqref{eq:auxiliary_power} is constructed iteratively from its orthogonal projection.
				Although a formal proof remains elusive, empirical evidence from simulation indicates that \eqref{eq:auxiliary_power} converge, and thus \eqref{eq:ris_power} converges to a stationary point, for extensively tested scenarios.
			\end{remark}
		}
	}
\end{reviewer}


\begin{reviewer}
	\summary{
	This paper studies the potential of a group-connected \gls{bd}-\gls{ris} to manipulate the \gls{mimo} channel in terms of singular values, power gain, and achievable rate. The analysis and optimization are based on the assumption of asymmetric and lossless \gls{ris} circuit network without mutual coupling. A geodesic design framework is proposed and tested on Pareto frontier shaping and joint beamforming problems. Some analytical bounds on channel singular values and power gain are also provided. Overall, it is a solid work with interesting results. I have some further comments for the authors' reference.
	}

	\comment{
		How practical is it to consider asymmetric reconfigurable \gls{bd}-\gls{ris}? How much gain is expected over symmetric ones and at what cost?
	}

	\reply{
		Asymmetric \gls{ris} may be built over asymmetric passive components (e.g., ring hybrids and branch-line hybrids).
		A 4-port ring hybrid is illustrated in the figure below \cite{Ahn2006}.
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.5\textwidth]{../assets/review/ring_hybrid.pdf}
			\caption*{
				Fig. A 4-port asymmetric ring hybrid. Here the arc length between ports are $\Theta_1 = \Theta_2 = \Theta_3 = \lambda / 4$ and $\Theta_4 = 3 \lambda / 4$ where $\lambda$ is the wavelength. The termination admittances $Y_a$ to $Y_d$ are arbitrary and the characteristic admittances of transmission-line sections are not necessarily the same, such that the scattering parameters can be asymmetric. Source: modified from \cite{Ahn2006}.
			}
		\end{figure}

		On the other hand, symmetric \gls{ris} satisfying $\mathbf{\Theta} = \mathbf{\Theta}^\mathsf{T}$ are often considered in the literature as they can be implemented with simpler circuit components (e.g., capacitors and inductors).
		We have added Section \ref{sc:ris_symmetry} to investigate the impact of \gls{ris} symmetry on the system performance.

		\change{
			Symmetric \gls{ris} satisfying $\mathbf{\Theta} = \mathbf{\Theta}^\mathsf{T}$ are often considered in the literature due to hardware constraints.
			This study aim to investigate the impact of \gls{ris} symmetry on the system performance.
			\begin{remark}
				All proposed asymmetric \gls{bd}-\gls{ris} designs can be modified for symmetry. In particular,
				\begin{enumerate}[label=(\roman*)]
					\item \emph{\gls{svd}-based (e.g., \eqref{eq:ris_nd_sv_indl}, \eqref{eq:ris_nd_power}, \eqref{eq:ris_nd_rate_max}, \eqref{eq:ris_power}, \eqref{eq:ris_procrustes}):} Those closed-form asymmetric solutions are constructed from the product of singular matrices. If symmetry is required, one can replace the $\mathbf{U}, \mathbf{V}$ from the \gls{svd} of $\mathbf{A} = \mathbf{U} \mathbf{\Sigma} \mathbf{V}^\mathsf{H}$ by the factor $\mathbf{Q}$ from the Autonne-Takagi factorization of $\frac{\mathbf{A} + \mathbf{A}^\mathsf{T}}{2} = \mathbf{Q} \mathbf{\Sigma} \mathbf{Q}^\mathsf{T}$ \cite{Ikramov2012} to construct the corresponding $\mathbf{\Theta}$;
					\item \emph{\gls{rcg}-based (e.g., \eqref{eq:shaping_subdiff}, \eqref{eq:gradient_eucl_rate}):} The symmetry constraint is added to the corresponding optimization problems, and one can project the solution to the nearest symmetric point $\mathbf{\Theta} \gets \frac{\mathbf{\Theta} + \mathbf{\Theta}^\mathsf{T}}{2}$ after each iteration.
				\end{enumerate}
			\end{remark}

			\begin{figure}[H]
				\centering
				\subfloat[Power: $2 \times N_\mathrm{S} \times 2$]{
					\resizebox{!}{5cm}{
						\input{../assets/simulation/pc_power_symmetry.tex}
					}
				}
				\subfloat[Rate: $4 \times N_\mathrm{S} \times 4$]{
					\resizebox{!}{5cm}{
						\input{../assets/simulation/pc_rate_symmetry.tex}
					}
				}
				\caption*{
					Fig. Impact of \gls{ris} symmetry on the power gain and achievable rate of \gls{mimo} point-to-point channel.
				}
			\end{figure}

			Figs. \ref{fg:pc_power_symmetry} and \ref{fg:pc_rate_symmetry} compare the power gain and achievable rate of \gls{mimo} point-to-point channel under asymmetric and various symmetric \gls{ris} configurations.
			Here, `Asymmetric' refers to the benchmark solution by \eqref{eq:ris_power} or \eqref{eq:gradient_eucl_rate}, `Enforced' refers to enforcing symmetry on `Asymmetric', `Legacy' refers to a straightforward extension of the \gls{siso} \gls{snr}-optimal solution \cite[(6)]{Santamaria2023}, `Takagi' refers to the modification \ref{it:takagi}, and `Projection' refers to the modification \ref{it:projection}.
			We observe that the performance gaps between the asymmetric and symmetric \gls{ris} configurations are insignificant and tends to widen with the number of scattering elements.
			The two proposed modifications also outperform other candidates in both problems.
		}
	}

	\comment{
		The geodesic \gls{rcg} method seems promising especially at large group size $L$. Is it possible to extend the design framework to advanced \gls{bd}-\gls{ris} architectures (e.g., multi-sector mode)?
	}

	\reply{
		Unfortunately, the geodesic \gls{rcg} method relies on the block unitary property of the \gls{bd}-\gls{ris} scattering matrix and is not directly applicable to multi-sector mode \gls{bd}-\gls{ris} where the constraint is relaxed to $\sum_{s=1}^S \mathbf{\Theta}_{g,s}^\mathsf{H} \mathbf{\Theta}_{g,s} = \mathbf{I}, \ \forall g \in [G]$ with $S > 1$ sectors.
	}

	\comment{
		For fully-connected \gls{bd}-\gls{ris}, the authors mentioned in the result section that power gain-optimal scattering matrix is also rate-optimal. Can you provide a proof on this point?
	}

	\reply{
		This is truly an interesting observation.
		When the direct channel is negligible and \gls{bd}-\gls{ris} is fully-connected, the power gain-optimal and rate-optimal scattering matrices derived in closed form \eqref{eq:ris_nd_power_max} and \eqref{eq:ris_nd_rate_max} indeed coincide with each other.
		When the direct channel is significant, the observation still holds, yet we do not have a formal proof due to the non-trivial solution structures.
		The following context has been added to the manuscript to support this claim.

		\change{
			Corollary \ref{co:nd_capacity_snr_general} also suggests that the power- and rate-optimal scattering matrices \eqref{eq:ris_nd_power_max} and \eqref{eq:ris_nd_rate_max} coincide with each other when the direct channel is negligible and the \gls{bd}-\gls{ris} is fully-connected.
			When either condition is not satisfied, active and passive beamforming are coupled and the rate-optimal solution involves alternating optimization.
			However, the power gain-optimal \gls{ris} still provides for a low-complexity decoupled solution.
		}
		\change{
			We also see that for fully-connected \gls{bd}-\gls{ris}, the power gain-optimal and rate-optimal points coincide with each other, as derived in  \eqref{eq:ris_nd_power_max} and \eqref{eq:ris_nd_rate_max}.
			This observation still holds in Figs. \subref*{fg:singular_pareto_sx32} -- \subref*{fg:singular_pareto_sx128} where the direct channel is significant, yet a formal proof is unavailable due to the non-trivial solution structures.
		}
	}

	\comment{
		The authors refer to \cite{Li2024} for estimating forward and backward channels individually. However, it can be challenging to implement those in real time without RF chains at the \gls{ris}. The impact of imperfect \gls{csi} on the achievable rates may also be studied.
	}

	\reply{
		We agree with the reviewer that the estimation of individual forward and backward channels may be challenging in practice.
		Section \ref{sc:estimation_error} has been added to investigate the impact of imperfect \gls{csi} on the proposed beamforming designs.

		\change{
			\begin{figure}[H]
				\centering
				\subfloat[Pareto: $2 \times 64 \times 2$]{
					\resizebox{!}{3.15cm}{
						\input{../assets/simulation/pc_singular_csi.tex}
					}
				}
				\subfloat[Rate: $4 \times 128 \times 4$]{
					\resizebox{!}{3.15cm}{
						\input{../assets/simulation/pc_rate_csi.tex}
					}
				}
				\caption{
					Impact of \gls{ris} channel estimation error on the \gls{mimo} singular value region and achievable rate.
					A higher transparency of the Pareto frontier indicates a larger channel estimation error.
					`D' means \gls{d}-\gls{ris} and `BD' refers to fully-connected \gls{bd}-\gls{ris}.
				}
			\end{figure}

			Figs. \ref{fg:pc_singular_csi} and \ref{fg:pc_rate_csi} investigates how \gls{ris} channel estimation errors affect the system performance in terms of singular value region and achievable rate.
			We assume the direct channel can be perfectly acquired and the estimated backward and forward channels are modeled by
			\begin{equation*}
				\hat{\mathbf{H}}_{\mathrm{B/F}} = \mathbf{H}_{\mathrm{B/F}} + \tilde{\mathbf{H}}_{\mathrm{B/F}},
			\end{equation*}
			where the error follows $\mathrm{vec}(\tilde{\mathbf{H}}_{\mathrm{B/F}}) \sim \mathcal{N}_\mathbb{C}(\mathbf{0}, \epsilon \Lambda_\mathrm{B} \Lambda_\mathrm{F}\mathbf{I})$.
			The results are evaluated over the ground truth channels.
			It is observed that the proposed channel shaping and joint beamforming solutions are reasonably robust to channel estimation errors.
			An interesting observation is that a \gls{bd}-\gls{ris} designed over extremely poorly estimated channels ($\epsilon = 0.5$) may still outpeform a \gls{d}-\gls{ris} designed over almost perfectly estimated channels ($\epsilon = 0.01$).
			We hope those results can motivate further research on the robust shaping/beamforming design and provide insights for practical \gls{bd}-\gls{ris} deployment.
		}
	}

	\comment{
		Some sentences are confusing to me and the presentation can be improved. For example, ``a group-wise geodesic \gls{rcg} method that operates directly on the Stiefel manifold''. Please elaborate more on this.
	}

	\reply{
		Thank you for the feedback. The manuscript has been carefully restructured and proofread for improved clarity and readability.
	}

\end{reviewer}


\begin{reviewer}
	\summary{
		This paper analyzes the channel shaping of a \gls{p2p} \gls{mimo} system, assisted by passive diagonal and/or non-diagonal \glspl{ris} to enhance power and rate gains. Overall, the topic is timely and interesting. Using \gls{ao}, a local optimal solution of the rate maximization for the \gls{bd}-\gls{ris}-assisted \gls{mimo} \gls{p2p} system is obtained. It is shown that \gls{bd}-\gls{ris} improve the achievable rate. To the best of my knowledge, the analysis is solid. However, there are some suggestions for improving the paper further.
	}

	\comment{
		The results for the \gls{p2p} system are insightful. However, a \gls{p2p} system is not typically considered a practical system. It is challenging to extend the results to a system with interfering signals, where the goal is not only to enhance the channel gain of the desired links but also simultaneously to reduce the channel gain of the interfering links. It is more interesting to investigate the rate region of $K$-user \glspl{ic}. It is expected that the authors provide an analysis of the (max-min and sum) rate maximization of multi-user \gls{mimo} systems, assisted by \gls{bd}-\glspl{ris}.
	}

	\reply{
		We appreciate the reviewer's positive feedback and insightful suggestion.
		Interference management by \gls{ris} in multi-user \gls{mimo} systems is indeed an interesting topic, but the page limit is a serious concern and we have to prioritize the point-to-point content.
		The study on \gls{bd}-\gls{ris}-aided interference channel deserves another submission and we are happy to share some initial results with you.

		\change{
			\setcounter{subfigure}{0}
			\begin{figure}[H]
				\centering
				\subfloat[Interference: $(4 \times N_\mathrm{S} \times 4)^5$]{
					\label{fg:ic_interference_sx}
					\resizebox{!}{5cm}{
						\input{../assets/simulation/ic_interference_sx.tex}
					}
				}
				\subfloat[WSR: $(2 \times 128 \times 2)^2, N_\mathrm{E} = 2$]{
					\label{fg:ic_wsr_beamforming}
					\resizebox{!}{5cm}{
						\input{../assets/simulation/ic_wsr_beamforming.tex}
					}
				}
				\\
				\subfloat[WSR: $(4 \times N_\mathrm{S} \times 4)^5, N_\mathrm{E} = 4$]{
					\label{fg:ic_wsr_sx}
					\resizebox{!}{5cm}{
						\input{../assets/simulation/ic_wsr_sx.tex}
					}
				}
				\subfloat[WSR: $(N_\mathrm{T} \times 128 \times N_\mathrm{R})^{10}, N_\mathrm{E} = 2$]{
					\label{fg:ic_wsr_txrx}
					\resizebox{!}{5cm}{
						\input{../assets/simulation/ic_wsr_txrx.tex}
					}
				}
				\caption{
					Average leakage interference and weighted sum-rate versus \gls{ris} and \gls{mimo} interference channel configurations.
					`Alternate' refers to the alternating optimization and `Decouple' refers to the low-complexity design.
					`D' means \gls{d}-\gls{ris} and `BD' refers to fully-connected \gls{bd}-\gls{ris}.
				}
			\end{figure}

			Fig.~\ref{fg:ic_interference_sx} illustrates how \gls{bd}-\gls{ris} helps to reduce the leakage interference.
			In this case, a fully-connected $2^n$-element \gls{bd}-\gls{ris} is almost as good as a $2^{n+2}$-element \gls{d}-\gls{ris} in terms of leakage interference.
			The result also implies that \gls{bd}-\gls{ris} can achieve a higher \gls{dof} than diagonal \gls{ris} in \gls{mimo} interference channel, which generalizes Proposition \ref{pp:dof} and emphasizes the potential of \gls{bd}-\gls{ris} in interference alignment.

			Fig.~\ref{fg:ic_wsr_beamforming} compares the average \gls{wsr} achieved by the optimal and low-complexity beamforming designs, respectively.
			Unlike the point-to-point case, the latter is not as effective as the former.
			The reason is that, for $K$ transmissions of different path loss, interference alignment using only a shared passive beamformer is very challenging especially, when the direct channels are dominant.
			On the other hand, using $K$ precoders in the joint beamforming design can reasonably orthogonalize the channels and the \gls{ris} can simply enhance the signal power.
			A narrower performance gap is expected when $N_\mathrm{S}$ increases or \gls{ris} coverage area shrinks.

			Figs.~\ref{fg:ic_wsr_sx} and \ref{fg:ic_wsr_txrx} show the average \gls{wsr} versus the number of scattering elements and transceiving antennas.
			Again, we observe that the rate gain of \gls{bd}-\gls{ris} over \gls{d}-\gls{ris} increases with $N_\mathrm{S}$, $N_\mathrm{T}$, and $N_\mathrm{R}$.
			The reasons have been discussed in the point-to-point case.

			\begin{figure}[H]
				\centering
				\resizebox{!}{5cm}{
					\input{../assets/simulation/ic_wsr_pair.tex}
				}
				\caption{Impact of channel estimation error and transceiver pairs on the weighted sum-rate of $(2 \times 64 \times 2)^K$ \gls{mimo} interference channel with $P = \qty{20}{dB}$ and $N_\mathrm{E} = 2$.
				}
				\label{fg:ic_wsr_pair}
			\end{figure}

			Fig.~\ref{fg:ic_wsr_pair} shows the average \gls{wsr} versus the backward/forward channel estimation error and the number of transceiver pairs.
			Specifically, the active and passive beamformers are designed over the estimated backward and forward channels
			\begin{equation*}
				\hat{\mathbf{H}}_{\mathrm{B/F}}^{(k)} = \mathbf{H}_{\mathrm{B/F}}^{(k)} + \tilde{\mathbf{H}}_{\mathrm{B/F}}^{(k)}, \quad \forall k,
			\end{equation*}
			where the error follows $\mathrm{vec}(\tilde{\mathbf{H}}_{\mathrm{B/F}}^{(k)}) \sim \mathcal{N}_\mathbb{C}(\mathbf{0}, \epsilon \Lambda_\mathrm{B} \Lambda_\mathrm{F}\mathbf{I})$.
			The \gls{wsr} is evaluated using the true channels.
			We observe that the proposed joint beamforming design is reasonably robust to channel estimation error and thus viable for practical implementation.
			On the other hand, introducing a \gls{ris} to interference channel systems is helpful to mitigate the rate saturation effect as $K$ increases.
			In the saturated regime ($K \ge 4$), \gls{bd}-\gls{ris} provides a much larger \gls{wsr} than \gls{d}-\gls{ris} thanks to its superior shaping capability in aligning the interference subspaces.
			These results provide valuable insights for practical \gls{ris} design in dense connection scenarios, where proper \gls{bd} configurations can significantly enhance the network capacity.
		}
	}

	\comment{
		\gls{bd}-\glspl{ris} provide a greater number of optimization variables but at the expense of increased computational and implementation complexities. While the computational complexities of the proposed solutions are discussed in the paper, a comparison with \gls{d}-\gls{ris} is missing, which should be explicitly addressed in both the introduction and the main body. Additionally, the implementation complexities of \gls{bd}-\glspl{ris}, particularly in comparison to \gls{d}-\gls{ris}, necessitate a more comprehensive analysis. For instance, as highlighted in \cite{Soleymani2024b}, the energy efficiency of a \gls{bd}-\gls{ris} is significantly influenced by the static power consumption of its circuit elements. If the implementation cost of a \gls{bd}-\gls{ris} is substantial, its performance advantages could be considerably reduced.
	}

	\reply{
		We agree with the reviewer that the computational complexities of \gls{d}-\gls{ris} and fully-connected \gls{bd}-\gls{ris} deserve further attention.
		Apart from a summary in the introduction and an explicit analysis in the main body, we have also evaluated the average statistics of the \gls{ao} design for both architectures on the rate maximization problem \eqref{op:rate}.

		On the other hand, the implementation complexities of \gls{bd}-\gls{ris} is indeed a critical issue.
		An initial study has been conducted in \cite{Zhou2023} where the authors demonstrated the superior energy efficiency of \gls{bd}-\gls{ris} compared to both active \gls{ris} and relay systems.
		Our colleagues are currently working on a more comprehensive analysis and the results will be published in a separate paper.

		\change{
			The additional optimization cost of \gls{bd}-\gls{ris} over \gls{d}-\gls{ris} is affordable and the geodesic \gls{rcg} method is efficient on large-scale problems;
		}

		\change{
			That is, $\mathcal{O}_\mathrm{D}\bigl(N_\mathrm{S}\bigr)$ for \gls{d}-\gls{ris} and $\mathcal{O}_\mathrm{BD}\bigl(N_\mathrm{S}^3\bigr)$ for fully-connected \gls{bd}-\gls{ris}.
		}

		\change{
			\begin{table}[H]
				\caption*{Table: Performance of \gls{d}-\gls{ris} and Fully-Connected \gls{bd}-\gls{ris} on \eqref{op:rate}}
				\centering
				\resizebox{\columnwidth}{!}{
					\begin{tabular}{ccccccc}
						\toprule
						\multirow{3}{*}{\gls{ris} type} & \multicolumn{3}{c}{$N_\mathrm{S}=16$} & \multicolumn{3}{c}{$N_\mathrm{S}=256$}                                                               \\ \cmidrule(lr){2-4} \cmidrule(lr){5-7}
														& Objective                             & \begin{tabular}{@{}c@{}}Iterations\\(outer)\end{tabular}                             & Time [s]         & Objective        & \begin{tabular}{@{}c@{}}Iterations\\(outer)\end{tabular} & Time [s] \\ \midrule
						Diagonal                        & $\num{25.33}$                      & 2.06                                  & $\num{2.620e-2}$ & $\num{32.22}$ & 2.92      & 1.277    \\
						Fully-connected BD              & $\num{26.10}$                      & 3.84                                  & $\num{2.719e-2}$ & $\num{36.58}$ & 3.03      & 0.806    \\ \bottomrule
					\end{tabular}
				}
			\end{table}
			Table \ref{tb:complexity_bond} compares the performance of \gls{d}-\gls{ris} and fully-connected \gls{bd}-\gls{ris} on rate maximization problem \eqref{op:rate} using the \gls{ao} design in Section \ref{sc:rate_ao}, where $N_\mathrm{T}=N_\mathrm{R}=4$ and $P=\qty{20}{dB}$.
			The statistics are averaged over \num{100} independent runs.
			The fact that fully-connected \gls{bd}-\gls{ris} provides a higher achievable rate using slightly more outer iterations $I_\text{AO}$ than \gls{d}-\gls{ris} is consistent with our analysis.
			Interestingly, \emph{the former still ends up with shorter elapsed time,} which seems to contradict the complexity analysis that $\mathcal{O}_\mathrm{BD}\bigl(N_\mathrm{S}^3\bigr)$ for fully-connected \gls{bd}-\gls{ris} and $\mathcal{O}_\mathrm{D}\bigl(N_\mathrm{S}\bigr)$ for \gls{d}-\gls{ris}.
			One possible reason is that \gls{bd}-\gls{ris} only involves 1 backtracking line search per iteration while \gls{d}-\gls{ris} requires $N_\mathrm{S}$ times.
			Another reason is that the group-wise update of \gls{d}-\gls{ris} leads to slower convergence of inner iterations.
			These results suggest that optimizing \gls{bd}-\gls{ris} may be less computational intensive than expected.
		}
	}

	\comment{
		\label{cm:e}
		The authors considered a passive \gls{ris} architecture. However, another passive configuration, termed \gls{gp}, is discussed in \cite{Fotock2023,Soleymani2024a}. Employing \gls{ao}, the resulting optimization problem to update $\mathbf{\Theta}$ is convex. Comparing the proposed solutions with a globally passive \gls{bd}-\gls{ris} would provide valuable insights into the performance gains obtained by relaxing the (locally) passive assumption. Hence, it is highly recommended to add the \gls{gp} (both \gls{bd} and diagonal) architecture as a benchmark in the numerical results.
	}

	\reply{
		We appreciate the reviewer's suggestion and agree that the \gls{gp} architecture may serve as a canonical benchmark.
		However, the current manuscript already exceeds the page limit and we decided not to overwhelm the readers with too many fancy \gls{ris} configurations.
		An in-depth comparison between \gls{gp} and \gls{bd} architectures holds significant value to the \gls{ris} community and deserves a separate study in the future.
	}

\end{reviewer}


\bibliographystyle{IEEEtran}
\bibliography{supplement}
\end{document}
